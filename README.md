# Land-use change impacts on wind profiles according to regional climate models

To enhance reproducibility and transparency in scientific publishing, we here provide the code that is used in 

Wohland, J., Hoffmann, P., Lima, D. C. A., Breil, M., Asselin, O., and Rechid, D.: Extrapolation is not enough: Impacts of extreme land-use change on wind profiles and wind energy according to regional climate models, EGUsphere [preprint], https://doi.org/10.5194/egusphere-2023-2533, 2023.

Please reference above  publication if you decide to use (parts of) this code for your own work.

## How to run it?

### 1) Install the anaconda environment and activate it

You can create the conda environment by running

> conda env create --file lucas_3dwinds.yaml

Next, you can activate it with

> conda activate lucas_3dwinds

If you are not running on Linux, the above comment might be sligthly different.

#### 1b) Environment mit pinned versions (you do not need to use it. It's here for completeness)

We also provide an environment with details about the specific versions that have been used and including additional packages that UNIX installed on our machine when creating the environment as defined above.
This environment is called `lucas_3dwinds_pinned_unix.yml` and we provide it in case there will be confusing stemming from package versioning. Please note that you will generally not be successful when recreating an environment from this yml with pinned versions. We refer to the Conda documentation [1] for further explanation. Basically, `lucas_3dwinds.yaml` follows the recommendations to export an environment file across platforms and is slimmed down while `lucas_3dwinds_pinned_unix.yml` provides all dependecies and pinned packages, and proves difficult to use on different systems. 


### 2) Executing all scripts
Running the full analysis is as easy as this: Activate the environment, go the `code` folder and then run

> bash main.sh

### Structure and naming convention

If you want to dig deeper, the files in this repository  are named according to a three step structure. 

Scripts that preprocess data begin with `preprocess_` followed by the name of the institute that ran the simulations. 
Similarly, computations (e.g., interpolation to hub height) happens in scripts beginning in `compute_` followed by a brief description of what they compute.
Lastly, scripts that provide plots or data for Tables are named `analyze_` followed by a brief description. 

In addition, there are two scripts providing additional functions (i.e., `utils` and `utils_from_CESM2energy`) and two 
files containing parameters (`params.py` and `approximate_heights.yaml`).

The environment is provided as `lucas_3dwinds.yaml`


## Input data
The input data needed for this analysis is a few TB large and open data sharing platforms 
like Zenodo do not host datasets of this size. If you want to re-execute the analysis 
(rather than just checking the code), feel free to reach out and we will see what we can do.

## Which Figure is generated by which function?

Below you find an overview of the paper and supplementary Figures and how they are generated. 

| Figure	| Filename	| Generating function |
| -----	| -----	| ----- |
| 1	| Diff_maps_GERICS_paper.jpeg	| analyze_monthly_means.plot_maps_per_height_paper()|
|2 |	Diff_maps_IDL_paper.jpeg |	analyze_monthly_means.plot_maps_per_height_paper()
|Table 2 |	Table_absolute_change_GERICS.txt and Table_absolute_change_IDL.txt	|analyze_monthly_means.stats_per_height()
|3|	Signal_decay_mean_log_onshore.jpeg |	analyze_monthly_means.plot_signal_decay_mean_log()
|4|	Signal_decay_quantiles_all.jpeg	|analyze_monthly_means.plot_decay_quantiles_all()
|5|	Profile_Germany_paper.jpeg	|analyze_subdaily.plot_profile_subdaily()
|6|	summernights_IDL.jpeg	|analyze_summernights_IDL.py
|7|	Mean_CF_change_maps.png	|analyze_generation.plot_mean_maps()
|8|	CF_distribution_time-mean.png	|analyze_generation.plot_mean_histograms()
|S1|	GRASS_example_wind_interpolation_GERICS_2000.png	|compute_hub_height.plot_illustration_location()
|S2	|Diff_maps_DJF_GERICS_paper.jpeg	|analyze_monthly_means.plot_maps_per_height_paper()
|S3|	Diff_maps_MAM_GERICS_paper.jpeg	|analyze_monthly_means.plot_maps_per_height_paper()
|S4|	Diff_maps_JJA_GERICS_paper.jpeg	|analyze_monthly_means.plot_maps_per_height_paper()
|S5|	Diff_maps_SON_GERICS_paper.jpeg	|analyze_monthly_means.plot_maps_per_height_paper()
|S6|	Diff_maps_DJF_IDL_paper.jpeg	|analyze_monthly_means.plot_maps_per_height_paper()
|S7|	Diff_maps_MAM_IDL_paper.jpeg	|analyze_monthly_means.plot_maps_per_height_paper()
|S8|	Diff_maps_JJA_IDL_paper.jpeg	|analyze_monthly_means.plot_maps_per_height_paper()
|S9|	Diff_maps_SON_IDL_paper.jpeg	|analyze_monthly_means.plot_maps_per_height_paper()
|S10|	land_sea_mask.jpeg	|utils.compute_land_sea_mask()
|S11|	Case_study_definitions.jpeg	|analyze_subdaily.plot_focus_areas()
|S12|	Profile_Spain_paper.jpeg	|analyze_subdaily.plot_profile_subdaily()
|S13|	Profile_Sweden_paper.jpeg	|analyze_subdaily.plot_profile_subdaily()
|S14|	Mean_CF_change_relative_diff_maps.png	|analyze_generation.plot_relative_change()

## Reference

The power curve of the SWT120-3600 wind turbine (`output/final_power_curve_1.p`) is based on the windpowerlib:

Haas, S., Schachler, B. & Krien, U. Windpowerlib - a Python Library to Model Wind Power Plantsâ€”v.0.2.0. Zenodo (2019) doi:https://doi.org/10.5281/zenodo.3403360.

[1] https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#exporting-an-environment-file-across-platforms
